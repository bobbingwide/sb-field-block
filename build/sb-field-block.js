(()=>{"use strict";var e={n:o=>{var l=o&&o.__esModule?()=>o.default:()=>o;return e.d(l,{a:l}),l},d:(o,l)=>{for(var t in l)e.o(l,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:l[t]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const o=window.wp.blocks,l=window.wp.i18n,t=window.wp.blockEditor,s=window.wp.components,n=window.wp.data,r=window.wp.coreData,a=window.wp.element,i=window.ReactJSXRuntime;const c=e=>{const o=(0,n.useSelect)((o=>o("oiksb/fields").getFields(e.type)),[e.type]);console.log("FieldSelect"),console.log(o),console.log(e),console.log("FS after");var l,t,r,a=(l=o,t=e.postType,r=function(e,o){if(console.log(e),0===e.length)return[];var l=e.filter((function(e){return e.postType==o}));return console.log(l),l.length?l[0].fields:[]}(l,t),console.log(r),r?r.map((e=>function(e){return{value:e.name,label:e["#title"]}}(e))):[]);return(0,i.jsx)(s.SelectControl,{label:"Field",value:e.value,options:a,onChange:e.onChange})},d=e=>{const o=(0,n.useSelect)((e=>e("core").getPostTypes({per_page:-1})),[]);if(console.log("PostTypeSelect"),console.log(o),console.log(e),console.log("PT after"),o&&o.length)var l=o.map((e=>function(e){return{value:e.slug,label:e.name}}(e)));else l=[{value:"",label:"Wait for it..."}];return(0,i.jsx)(s.SelectControl,{label:"Post Type",value:e.value,options:l,onChange:e.onChange})},p=window.wp.apiFetch;var u=e.n(p);const f={getFields(e,o){const{fields:l}=e;return l}},g={*getFields(e){const o=yield w.getFields("/oiksb/v1/fields");return w.setFields(o)}},w={setFields:e=>({type:"SET_FIELDS",fields:e}),getFields:e=>({type:"GET_FIELDS",path:e})},b={GET_FIELDS:e=>u()({path:e.path})};(0,n.registerStore)("oiksb/fields",{actions:w,controls:b,reducer:function(e={fields:[]},o){return console.log("reducer"),console.log(e),console.log(o),"SET_FIELDS"===o.type?{...e,fields:o.fields}:e},resolvers:g,selectors:f});const h=window.wp.serverSideRender;var v=e.n(h);function y(e,o){var l=function(e){const o=(0,n.useSelect)((e=>e("oiksb/fields").getFields()),[]);console.log("getPostFields"),console.log(o);var l=o.find((({postType:o})=>o===e));return console.log(l),console.log("GPF after"),l}(e);if(!l)return null;var t=l.fields.find((({name:e})=>e===o));return console.log(t),t}const m=e=>{var o=e.postType,l=e.fieldName,t=e.fieldValue,s=function(e,o){var l=y(e,o);return l?l["#title"]:o}(o,l),n=function(e,o){var l=y(e,o);return l?l["#field_type"]:void 0}(o,l);if(function(e){console.log(e);var o={text:!1,number:!1};return!o.hasOwnProperty(e)||o.fieldType}(n)){let o={post_id:e.context.postId};return(0,i.jsx)(v(),{block:"oiksb/sb-field-block",attributes:e.attributes,urlQueryArgs:o})}return e.attributes.showLabel?(0,i.jsxs)("div",{className:"bw_metadata "+l,children:[(0,i.jsx)("span",{className:"label "+l,children:s}),(0,i.jsx)("span",{className:"sep",children:": "}),(0,i.jsx)("span",{className:"value",children:t})]}):(0,i.jsx)("div",{className:"bw_metadata "+l,children:(0,i.jsx)("span",{className:"value",children:t})})};(0,o.registerBlockType)("oiksb/sb-field-block",{edit:function({setAttributes:e,attributes:o,context:p}){const u=(0,t.useBlockProps)();console.log(p);var f=void 0;f=(0,n.useSelect)((e=>e("core/editor").getCurrentPostType()),[]),o.postType&&(f=o.postType);var[g,w]=(0,r.useEntityProp)("postType",f,"meta");console.log("Meta before"),console.log(g),console.log("MA");const b=g&&""!=o.fieldName?g[o.fieldName]:"Please set Field name";return(0,i.jsxs)(a.Fragment,{children:[(0,i.jsxs)(t.InspectorControls,{children:[(0,i.jsx)(s.PanelBody,{children:(0,i.jsx)(s.PanelRow,{children:(0,i.jsx)(d,{value:o.postType,onChange:function(o){e({postType:o})}})})}),(0,i.jsx)(s.PanelBody,{children:(0,i.jsx)(s.PanelRow,{children:(0,i.jsx)(c,{value:o.fieldName,onChange:o=>{e({fieldName:o})},postType:o.postType})})}),(0,i.jsx)(s.PanelBody,{children:(0,i.jsx)(s.PanelRow,{children:(0,i.jsx)(s.ToggleControl,{label:(0,l.__)("Show label","sb-field-block"),checked:!!o.showLabel,onChange:l=>{e({showLabel:!o.showLabel})}})})})]}),(0,i.jsx)("div",{...u,children:(0,i.jsx)(m,{postType:o.postType,fieldName:o.fieldName,fieldValue:b,attributes:o,context:p})})]})},save:function(){return null}})})();